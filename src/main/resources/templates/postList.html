<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko"
xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>porlog</title>
  
<!-- ì˜¤í”ˆê·¸ë˜í”„ -->
<meta property="og:type" content="website" />
<meta property="og:site_name" content="porlog" />
<meta property="og:title" content="Belog KOSTA KOREA" />
<meta property="og:description" content="porlogëŠ” 2021ë…„6ì›”1ì¼~7ì›”12ì¼ì— ê°œë°œí•œ í™ˆí˜ì´ì§€ì…ë‹ˆë‹¤." />
<meta property="og:image" content="images/logo-1.png" />
<meta property="og:url" content="" />
<!-- íŠ¸ìœ„í„°ì¹´ë“œ  -->
<meta property="twitter:card" content="summary" />
<meta property="twitter:site" content="porlog" />
<meta property="twitter:title" content="porlogëŠ” KOSTA KOREA" />
<meta property="twitter:description" content="BelogëŠ” 2021ë…„6ì›”1ì¼~7ì›”12ì¼ì— ê°œë°œí•œ í™ˆí˜ì´ì§€ì…ë‹ˆë‹¤." />
<meta property="twitter:image" content="images/logo-1.png" />
<meta property="twitter:url" content="" />
<!-- êµ¬ê¸€ í°íŠ¸ -->
<link rel="preconnect" href="https://fonts.gstatic.com" />
<link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&display=swap" rel="stylesheet" />
<!--êµ¬ê¸€ ì•„ì´ì½˜API  -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<!-- ë¸Œë¼ìš°ì ¸ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”  -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reset-css@5.0.1/reset.min.css">
<!-- ë¸Œë¼ìš°ì ¸ íƒ€ì´í‹€ ì´ë¯¸ì§€ -->
<link rel="icon" href="images/logo-1.png">
<!-- css  -->
<link rel="stylesheet" href="css/sample.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- js -->
<script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
<script defer src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script defer src="js/sample.js"></script>

<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

</head>

<body>
  <!-- HEADER -->
  <header>
    <div class="inner">
      <a href="/index" class="logo"><img src="images/logo-2.png" alt="Belog" class="img_title"></a>
      <div class="sub-menu">
        <ul class="menu">
			<li sec:authorize="!isAuthenticated()"><a href="#" data-toggle="modal" data-target="#myModal" id="">ë¡œê·¸ì¸ </a></li>
			<li sec:authorize="isAuthenticated()"><span sec:authentication="principal.username" id="logouttext"></span></li> 
			<li sec:authorize="isAuthenticated()"><a th:href="@{/logout}">ë¡œê·¸ì•„ì›ƒ</a></li>
			<li sec:authorize="!isAuthenticated()"><a href="#" data-toggle="modal" data-target="#exampleModal">íšŒì›ê°€ì…</a></li>
        </ul>
        <div class="search">
          <input type="text">
          <div class="material-icons">
            search
          </div>
        </div>
      </div>
      <ul class="main-menu">
        <li class="item">
          <div class="item__name"><div class="material-icons">menu</div></div>
          <div class="item__contents">
            <div class="contents__menu">
              <ul class="inner">
                <li>
                  <h4>ì±„ìš©ì •ë³´</h4>
                  <ul>
                    <li>ì§€ì—­ë³„</li>
                    <li>ì§ì—…ë³„</li>
                  </ul>
                </li>
                <li>
                  <h4>í´ë¡œê·¸</h4>
                  <ul>
                    <li></li>
                    <li></li>
                  </ul>
                </li>
                <li>
                  <h4>ë‚´ í´ë¡œê·¸</h4>
                  <ul>
                    <li>í´ë¡œê·¸ í™•ì¸</li>
                    <li>í´ë¡œê·¸ ìˆ˜ì •</li>
                    <li>í´ë¡œê·¸ ì‚­ì œ</li>
                  </ul>
                </li>
              </ul>
            </div>
            <div class="contents__texture">
              <div class="inner">
                <!-- <h4>ë‚˜ì™€ ì–´ìš¸ë¦¬ëŠ” ì»¤í”¼ ì°¾ê¸°</h4>
                <p>ìŠ¤íƒ€ë²…ìŠ¤ê°€ ì—¬ëŸ¬ë¶„ì—ê²Œ ì–´ìš¸ë¦¬ëŠ” ì»¤í”¼ë¥¼ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤.</p>
                <h4>ìµœìƒì˜ ì»¤í”¼ë¥¼ ì¦ê¸°ëŠ” ë²•</h4>
                <p>ì—¬ëŸ¬ê°€ì§€ ë°©ë²•ì„ í†µí•´ ë‹¤ì–‘í•œ í’ë¯¸ì˜ ì»¤í”¼ë¥¼ ì¦ê²¨ë³´ì„¸ìš”.</p> -->
              </div>
            </div>
          </div>
        </li>
        <li class="item">
          <div class="item__nameA">
          	<a th:href="@{/jInfo}">ì±„ìš©ì •ë³´</a>
          </div>
        </li>
        <li class="item">
          <div class="item__nameA">
          	<a th:href="@{/blogList}">í´ë¡œê·¸</a>
          </div>
        </li>
        <li class="item">
          <div class="item__nameA">
          	<div sec:authorize="isAuthenticated()">
				<a th:href="@{/basic(userID=${user?.userID})}" >ë‚´ í´ë¡œê·¸</a>
			</div>
			<div sec:authorize="isAnonymous()">
				<a th:href="@{/basic}" >ë‚´ í´ë¡œê·¸</a>
			</div>
          </div>
        </li>
      </ul>
    </div>
  </header>
  
<!-- Modal -->
<!--ë¡œê·¸ì¸  -->
<div id="myModal" class="modal fade" role="dialog">
	<div class="modal-dialog" style="width: 350px;" >
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>
				<h4 class="modal-title">Login</h4>
			</div>
			<div class="modal-body">
				<form method="post" action="index">
					<div class="form-group">
						<label for="exampleInputName">ID</label>
						<input type="text" class="form-control" id="exampleInputName" name="username" placeholder="ì•„ì´ë””">
						<a href="#" data-toggle="modal" id="registerCheck" >ì•„ì´ë”” ì¤‘ë³µì²´í¬</a>
					</div>
					<div class="form-group">
						<label for="exampleInputPassword1">Password</label>
						<input type="password" class="form-control" id="exampleInputPassword1" name="password" placeholder="Password">  
					</div>
					<input type="checkbox" name="idcheck" id="idSaveCheck" onClick="confirmSave(this)"> ì•„ì´ë””ì €ì¥<br>
					<input type="submit" class="btn btn-primary" id="login-login" value="login">
					<button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button><br>
				</form>
			</div>
			<div style="text-align: center;">
				<a href="#" data-toggle="modal" data-target="#exampleModal" id="registersend">íšŒì›ê°€ì…</a>
				<a href="#" data-toggle="modal" data-target="#exampleModalID" id="IDFind">ì•„ì´ë”” ì°¾ê¸°</a>
				<a href="#" data-toggle="modal" data-target="#exampleModalPW" id="PWFind">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
			</div>
		</div>
	</div>
</div>
  
  
  
  
  
  
  
  <!-- VISUAL   ì¡°ì›ë¶„ë“¤ì´ ê±´ë“œë ¤ì•¼í•  ë¶€ë¶„-->
  <section class="visual">
	<div style="width: 760px; margin: 0 auto; text-align: left; padding-top: 50px;">
		<h2><b>[[${blog.user.nickname}]]</b></h2>
		<p>[[${blog.blogTitle}]]</p>
  	</div>
  	<hr style="width: 760px;">
  	
  	<div class="side-menu">
		<div class="side-menu-title">
			<h3><b>ê²Œì‹œë¬¼ ì¹´íŠ¸</b></h3>
			<hr>
		</div>
		
		
		<div id="cart" style="width: 200px; min-height: 200px; border: 5px dotted  rgb(145, 106, 6);">
	    </div>
	
	</div>
  	
  	
  	
  	
  	
    <div class="inner2">
    
	<div class="post-area">
		<div class="post-box" th:each="post:${postlist}">
			<div class="post-thumbnail">
				<a th:href="@{/postDetail(postID=${post.postID})}">
					<img th:src="${post.postThumbnail}" />
					<input type="hidden" class="postID" th:value="${post.postID}"/>
				</a>
			</div>
			<div class="subinfo">
				<a th:href="@{/postDetail(postID=${post.postID})}"><h2><b>[[${post.postTitle}]]</b></h2></a>
				<span>[[${post.postDate}]]</span>
				<span>ì¡°íšŒìˆ˜ [[${post.viewCnt}]] </span>
				<button th:class="'btn-like'+${post.postID}" th:id="'likecnt'+${post.postID}" th:onclick="'like(\'likecnt'+${post.postID}+'\',\'btn-like'+${post.postID}+'\')'" th:text="'ğŸ‘'+${post.likeCnt}" style=" color: transparent;text-shadow: 0 0 2px rgba(255,255,255,.7), 0 0 0 #000; width: 100px;background-color: white;border: 0;"></button>
				<form th:id="'likeform'+${post.postID}">
					<input type="hidden" name="blogID" th:value="${blogID}">
					<input type="hidden" name="postID" id="example"  th:value="${post.postID}">
					<input type="hidden" name="like" id="like" th:value="${post.likeCnt}">
					<input type="hidden" name="pcheck" th:id="'check'+${post.postID}" th:value="0">
					<input type="hidden" name="ucheck" id="ucheck" th:value="${user.authLV}">
					<input type="hidden" name="uid" id="uid" th:value="${user.userID}">
				</form>
			</div>
			<br><br><hr>
		</div>
		
	</div>
    </div>
  </section>
 



  <!-- FOOTER -->
  <footer>
    <div class="inner">
      <div class="info">
        <span>ë°°ìœ¤í˜¸</span>
        <span>ê°•í¬ì›</span>
        <span>ì„ìƒí˜</span>
        <span>ë°°ì¬ì˜</span>
        <span>ì •í•œì˜</span>
      </div>
      <p class="copyright">
        &copy;<span class="this-year"></span>KOSTA TEAM4
      </p>
      <img src="./images/logo-2.png" alt="" class="logo">
    </div>
  </footer>

<script>

function like(id,cc){
	//ë²„íŠ¼ ì•„ì´ë””
	var key=Number(id.substr(7));
	//requestmappingì— ë„˜ê¸¸ê°’ì— keyê°’ ë„£ê¸°
	$("#example").val(key);
	//ë²„íŠ¼ ì•„ì´ë”” ê´€ë ¨
	var a= "#"+id;
	var p =$(a).text();	
	var h= Number(p.substr(2,4));
	//ê¸°íƒ€ ë‚´ìš©
	var likea=Number($("#like").val());
	
	//ë²„íŠ¼ í´ë˜ìŠ¤
	$("."+cc).toggleClass("done");
	
	//////var fa= Number($("#check"+key).val()); 
	
	//ë²„íŠ¼ í´ë˜ìŠ¤ ê´€ë ¨
	var s ="."+cc;
	//ë²„íŠ¼ ìŠ¤íƒ€ì¼
	$(s+':hover').css('text-shadow', '0 0 0 #ea0');
	
	
	//í´ë¦­í• ë•Œ doneì´ ë˜ê³  í˜ì´ì§€ë¥¼ ë‚˜ê°€ë„ ì €ì¥ì´ë˜ì–´ë¼!!
	
	 if($(a).attr("class").indexOf("done")>=0){ 
		 $(s).css('color', 'inherit');
		 $(s).css('text-shadow', '0');
		 $(a).text(h+1).prepend('ğŸ‘');
	   
	   
  			$("#like").val(likea+1); 
  			
		 
	}else{
		 $(s).css('color', 'transparent');
		 $(s).css('text-shadow', '0 0 0 #777');
		 
		 $(a).text(h-1).prepend('ğŸ‘');
			$("#like").val(likea-1); 
			
	} 
	console.log($('#likeform'+key).serializeArray());
	 $.ajax({
	 		url:'likepost',
			type:'POST',
			data:$('#likeform'+key).serializeArray(),
			success: function(data){
				
				$("#check"+key).val(data);
				
			},
			error:function(){
				
			}
	 	 }); 
	 
}







$(document).ready(function(){
	 $("#logouttext").append("ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤");
});


/* side menu */
$(function() {
	var wind = $(window),
		header = $('.side-menu'),
		headerOffsetTop = header.offset().top;
	wind.scroll(function() {
		if($(this).scrollTop() > headerOffsetTop) {
			header.addClass('sticky');
		} else {
			header.removeClass('sticky');
		}
	});
});



//------------------cartë¶€ë¶„-------------------


function displayCart(data) {
    var s = '';
    var sum = 0;
    var pp = '';
    for (var i= 0; i < data.length; i++) {
        sum += parseInt(data[i].quantity)
        console.log(data[i].post.postThumbnail);
        s += '<br><img src="'+data[i].post.postThumbnail+'" width="70" height="50">';
        s += 'Id: ' + data[i].post.postID;
        s += '<br>Name: ' + data[i].post.postTitle;
        s += `<br><a href="javascript:del('${data[i].post.postID}')" id=delete>Delete</a>`; 
        s += '<br>---------------------------------------';
    } 
    s += '<br>ë‹´ì€ ê²Œì‹œë¬¼ : ' + sum;
    
    $('#cart').html(s);
}

//cartì—ì„œ ì‚­ì œ
function del(postID){
    $.ajax({
        type: 'GET',
        dataType: 'json',
        contentType: 'application/json',
        url: '/cart/delete/' + postID,
        success: function (data) {
            displayCart(data);
        }
    });
}

$(document).ready(function() {
	//ì´ˆê¸°ê°’ ì„¤ì •
	var s = '<br>ë‹´ì€ ê²Œì‹œë¬¼ : 0';
	$('#cart').html(s);
	
	//ì´ë¯¸ì§€ ë“œë˜ê·¸ê¸°ëŠ¥ ì„¤ì •
    $('.post-thumbnail img').css({
        'z-index' : 1
    }).draggable({
        'opacity' : '0.5',
        'revert' : true,
        'cursor' : 'pointer'
    });
    
	//ì´ë¯¸ì§€ ë“œë˜ê·¸ ì‹œ cartì— ë‹´ê¸°
    $('#cart').droppable({
        drop: function (event, ui) {
            var postID = $(ui.draggable).siblings('.postID').val();
            var blogID = $("input[name='blogID']").val();
            //var data = {"postlist":$(".postlist").val(),};
            console.log(postID);
            console.log(blogID);
            $.ajax({
                type: 'GET',
                //data: data,
                //dataType: 'json',
                contentType: 'application/json',
                url: '/cart/buy/' + postID + '/' + blogID,
                success: function (data) {
                    displayCart(data);
                }
            });
        }
    });
});


</script>

</body>

</html>